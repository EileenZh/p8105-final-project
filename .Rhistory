nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
for (i in seq_along(nyc_jobs)) {
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
# change unit of salary and calculate mean
nyc_jobs$salary_frequency<-as.character((nyc_jobs$salary_frequency))
nyc_jobs$salary_range_from<- as.numeric(nyc_jobs$salary_range_from)
nyc_jobs$salary_range_to<- as.numeric(nyc_jobs$salary_range_to)
?mutate
nyc_jobs$work_location<-as.character(nyc_jobs$work_location)
geo <- geocode(location = nyc_jobs$work_location, output="latlon", source="google")
nyc_jobs<- nyc_jobs %>%
mutate(lon = geo$lon, lat = geo$lat) %>%
group_by(job_category)
mutate(salary_mean = (salary_range_to-salary_range_from)/2+salary_range_from)
View(nyc_jobs)
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
View(nyc_jobs)
for (i in seq_along(nyc_jobs)) {
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
nyc_jobs$salary_frequency<-as.character((nyc_jobs$salary_frequency))
nyc_jobs$salary_range_from<- as.numeric(nyc_jobs$salary_range_from)
nyc_jobs$salary_range_to<- as.numeric(nyc_jobs$salary_range_to)
nyc_jobs$work_location<-as.character(nyc_jobs$work_location)
geo <- geocode(location = nyc_jobs$work_location, output="latlon", source="google")
library(tidyverse)
library(haven)
library(readxl)
library(janitor)
library(ggmap)
library(plotly)
library(stringr)
```
#clean data
```{r}
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
#combine job category
for (i in seq_along(nyc_jobs)) {
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ")
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500)
nyc_jobs$work_location<-as.character(nyc_jobs$work_location)
geo <- geocode(location = nyc_jobs$work_location, output="latlon", source="google")
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
#combine job category
for (i in seq_along(nyc_jobs)) {
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs[[i]][str_detect(nyc_jobs[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"}
View(nyc_jobs)
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
View(nyc_jobs)
nyc_jobs$work_location<-as.character(nyc_jobs$work_location)
geo <- geocode(location = nyc_jobs$work_location, output="latlon", source="google")
View(nyc_jobs)
for (i in seq_along(nyc_jobs)) {
if(nyc_jobs$salary_frequency[[i]] == "Hourly"){
nyc_jobs$salary_frequency[[i]] = "Annual"
nyc_jobs$salary_range_from[[i]] = nyc_jobs$salary_range_from[[i]]*1825
nyc_jobs$salary_range_to[[i]] = nyc_jobs$salary_range_to[[i]]*1825
}
else if(nyc_jobs$salary_frequency[[i]] == "Daily"){
nyc_jobs$salary_frequency[[i]] = "Annual"
nyc_jobs$salary_range_from[[i]] = nyc_jobs$salary_range_from[[i]]*365*5/7
nyc_jobs$salary_range_to[[i]] = nyc_jobs$salary_range_to[[i]]*365*5/7
}
}
View(nyc_jobs)
nyc_jobs$salary_frequency[[1]] == "Hourly"
nyc_jobs$salary_frequency[[1]] == "Annual"
for (i in seq_along(nyc_jobs)) {
if(nyc_jobs$salary_frequency[i] == "Hourly"){
nyc_jobs$salary_frequency[i] = "Annual"
nyc_jobs$salary_range_from[i] = nyc_jobs$salary_range_from[[i]]*1825
nyc_jobs$salary_range_to[i] = nyc_jobs$salary_range_to[[i]]*1825
}
else if(nyc_jobs$salary_frequency[[i]] == "Daily"){
nyc_jobs$salary_frequency[[i]] = "Annual"
nyc_jobs$salary_range_from[[i]] = nyc_jobs$salary_range_from[[i]]*365*5/7
nyc_jobs$salary_range_to[[i]] = nyc_jobs$salary_range_to[[i]]*365*5/7
}
}
nyc_jobs$salary_frequency<-as.character((nyc_jobs$salary_frequency))
View(nyc_jobs)
class(nyc_jobs$salary_frequency)
for (i in seq_along(nyc_jobs)) {
if(nyc_jobs$salary_frequency[i] == "Hourly"){
nyc_jobs$salary_frequency[i] = "Annual"
nyc_jobs$salary_range_from[i] = nyc_jobs$salary_range_from[[i]]*1825
nyc_jobs$salary_range_to[i] = nyc_jobs$salary_range_to[[i]]*1825
}
else if(nyc_jobs$salary_frequency[[i]] == "Daily"){
nyc_jobs$salary_frequency[[i]] = "Annual"
nyc_jobs$salary_range_from[[i]] = nyc_jobs$salary_range_from[[i]]*365*5/7
nyc_jobs$salary_range_to[[i]] = nyc_jobs$salary_range_to[[i]]*365*5/7
}
}
View(nyc_jobs)
table(nyc_jobs$salary_frequency)
for (i in seq_along(nyc_jobs)) {
if(nyc_jobs$salary_frequency[[i]] == "Hourly"){
nyc_jobs$salary_frequency[[i]] = "Annual"}}
table(nyc_jobs$salary_frequency)
nyc_jobs$job_category[[1]]
nyc_jobs$job_category[1]
salary<- function(i){
if(nyc_jobs$salary_frequency[[i]] == "Hourly"){
nyc_jobs$salary_frequency[[i]] = "Annual"
nyc_jobs$salary_range_from[[i]]= nyc_jobs$salary_range_from[[i]]*1825
nyc_jobs$salary_range_to[i] = nyc_jobs$salary_range_to[[i]]*1825
}
else if(nyc_jobs$salary_frequency[[i]] == "Daily"){
nyc_jobs$salary_frequency[[i]] = "Annual"
nyc_jobs$salary_range_from[[i]] = nyc_jobs$salary_range_from[[i]]*365*5/7
nyc_jobs$salary_range_to[[i]] = nyc_jobs$salary_range_to[[i]]*365*5/7
}
}
for (i in seq_along(nyc_jobs)) {salary(i)}
table(nyc_jobs$salary_frequency)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$salary_frequency[[i]][nyc_jobs$salary_frequency[[i]] == "Hourly"] <- "Annual"
nyc_jobs$salary_range_from[[i]][nyc_jobs$salary_frequency[[i]] == "Hourly"] <- nyc_jobs$salary_range_from[[i]]*1825
nyc_jobs$salary_range_to[[i]][nyc_jobs$salary_frequency[[i]] == "Hourly"] <- nyc_jobs$salary_range_to[[i]]*1825}
class(nyc_jobs$salary_frequency)
table(nyc_jobs$salary_frequency)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$salary_frequency[[i]][nyc_jobs$salary_frequency[[i]] == "Hourly"] <- "Annual"
nyc_jobs$salary_range_from[[i]][nyc_jobs$salary_frequency[[i]] == "Hourly"] <- nyc_jobs$salary_range_from[[i]]*1825
nyc_jobs$salary_range_to[[i]][nyc_jobs$salary_frequency[[i]] == "Hourly"] <- nyc_jobs$salary_range_to[[i]]*1825}
nyc_jobs$salary_frequency[[35]][nyc_jobs$salary_frequency[[35]] == "Hourly"] <- "Annual"
nyc_jobs$salary_range_from[[35]][nyc_jobs$salary_frequency[[35]] == "Hourly"] <- nyc_jobs$salary_range_from[[i]]*1825
nyc_jobs$salary_range_from[[35]][nyc_jobs$salary_frequency[[35]] == "Hourly"] <- nyc_jobs$salary_range_from[[35]]*1825
nyc_jobs$salary_range_from[[35]][nyc_jobs$salary_frequency[[35]] == "Hourly"] <- nyc_jobs$salary_range_from[[35]]*1825
nyc_jobs$salary_range_from <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", salary_range_from*1825,salary_range_from))
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
nyc_jobs$salary_frequency<-as.character((nyc_jobs$salary_frequency))
nyc_jobs$salary_range_from<- as.numeric(nyc_jobs$salary_range_from)
nyc_jobs$salary_range_to<- as.numeric(nyc_jobs$salary_range_to)
nyc_jobs$salary_range_from <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", salary_range_from*1825,salary_range_from))
nyc_jobs$salary_range_to <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", salary_range_to*1825,salary_range_to))
nyc_jobs$salary_range_from <- with(nyc_jobs, ifelse(salary_frequency == "Daily", salary_range_from*365*5/7,salary_range_from))
nyc_jobs$salary_range_to <- with(nyc_jobs, ifelse(salary_frequency == "Daily", salary_range_to*365*5/7,salary_range_to))
mutate(nyc_jobs,salary_frequency="Annual")
nyc_jobs<-mutate(nyc_jobs,salary_frequency="Annual")
View(nyc_jobs)
salary<- function(x,y){
x <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", x*1825,x))
y <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", y*1825,y))
x <- with(nyc_jobs, ifelse(salary_frequency == "Daily", x*365*5/7,x))
y <- with(nyc_jobs, ifelse(salary_frequency == "Daily", y*365*5/7,y))
}
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
nyc_jobs$salary_frequency<-as.character((nyc_jobs$salary_frequency))
nyc_jobs$salary_range_from<- as.numeric(nyc_jobs$salary_range_from)
nyc_jobs$salary_range_to<- as.numeric(nyc_jobs$salary_range_to)
salary<- function(x,y){
x <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", x*1825,x))
y <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", y*1825,y))
x <- with(nyc_jobs, ifelse(salary_frequency == "Daily", x*365*5/7,x))
y <- with(nyc_jobs, ifelse(salary_frequency == "Daily", y*365*5/7,y))
}
salary(nyc_jobs$salary_range_from,nyc_jobs$salary_range_to)
View(nyc_jobs)
category<- function(x){
x[str_detect(x,regex("engineering", ignore_case = TRUE))] <- "Engineering"
x[str_detect(x,regex("finance", ignore_case = TRUE))] <- "Finance"
x[str_detect(x,regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
x[str_detect(x,regex("technology", ignore_case = TRUE))] <- "Technology"
x[str_detect(x,regex("policy", ignore_case = TRUE))] <- "Policy"
x[str_detect(x,regex("communi", ignore_case = TRUE))] <- "Community"
x[str_detect(x,regex("clerical", ignore_case = TRUE))] <- "Clerical"
x[str_detect(x,regex("social service", ignore_case = TRUE))] <- "Social service"
x[str_detect(x,regex("public safety", ignore_case = TRUE))] <- "Public safety"
x[str_detect(x,regex("administration", ignore_case = TRUE))] <- "Administration"
x[str_detect(x,regex("operations", ignore_case = TRUE))] <- "Maintance"
x[str_detect(x,regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
map_df(nyc_jobs$job_category,category)
map_df(nyc_jobs$job_category[],category)
map_df(nyc_jobs,category)
View(nyc_jobs)
rm(list=ls())
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
#combine job category (function?)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
# change unit of salary and calculate mean
nyc_jobs$salary_frequency<-as.character((nyc_jobs$salary_frequency))
nyc_jobs$salary_range_from<- as.numeric(nyc_jobs$salary_range_from)
nyc_jobs$salary_range_to<- as.numeric(nyc_jobs$salary_range_to)
nyc_jobs$salary_range_from <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", salary_range_from*1825,salary_range_from))
nyc_jobs$salary_range_to <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", salary_range_to*1825,salary_range_to))
nyc_jobs$salary_range_from <- with(nyc_jobs, ifelse(salary_frequency == "Daily", salary_range_from*365*5/7,salary_range_from))
nyc_jobs$salary_range_to <- with(nyc_jobs, ifelse(salary_frequency == "Daily", salary_range_to*365*5/7,salary_range_to))
nyc_jobs<-mutate(nyc_jobs,salary_frequency="Annual") %>%
mutate(salary_mean = (salary_range_to-salary_range_from)/2+salary_range_from)
nyc_jobs$work_location<-as.character(nyc_jobs$work_location)
geo <- geocode(location = nyc_jobs$work_location, output="latlon", source="google")
nyc_jobs<- nyc_jobs %>%
mutate(lon = geo$lon, lat = geo$lat) %>%
group_by(job_category)
nyc_jobs<- nyc_jobs %>%
mutate(lon = geo$lon, lat = geo$lat) %>%
group_by(job_category)
library(tidyverse)
library(haven)
library(readxl)
library(janitor)
library(ggmap)
library(plotly)
library(stringr)
nyc_jobs<- nyc_jobs %>%
mutate(lon = geo$lon, lat = geo$lat) %>%
group_by(job_category)
View(nyc_jobs)
View(geo)
View(geo)
nyc_jobs<- nyc_jobs %>%
mutate(lon = geo$lon, lat = geo$lat) %>%
group_by(job_category)
View(nyc_jobs)
table(nyc_jobs$job_category)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
library(tidyverse)
library(haven)
library(readxl)
library(janitor)
library(ggmap)
library(plotly)
library(stringr)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
table(nyc_jobs$job_category)
View(nyc_jobs)
table(nyc_jobs$job_category)
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
table(nyc_jobs$job_category)
View(nyc_jobs)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
View(nyc_jobs)
nyc_jobs<- read.csv("NYC_Jobs.csv") %>%
clean_names() %>%
filter(job_category!= " ",
full_time_part_time_indicator!=" ",
preferred_skills!= " ",
work_location!=" ") %>%
head(2500) #google map limited to 2500
nyc_jobs$job_category<- as.character(nyc_jobs$job_category)
for (i in seq_along(nyc_jobs)) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
for (i in 1:2500) {
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("engineering", ignore_case = TRUE))] <- "Engineering"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("finance", ignore_case = TRUE))] <- "Finance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("legal", ignore_case = TRUE))] <- "Legal Affairs"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("technology", ignore_case = TRUE))] <- "Technology"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("policy", ignore_case = TRUE))] <- "Policy"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("communi", ignore_case = TRUE))] <- "Community"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("clerical", ignore_case = TRUE))] <- "Clerical"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("social service", ignore_case = TRUE))] <- "Social service"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("public safety", ignore_case = TRUE))] <- "Public safety"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("administration", ignore_case = TRUE))] <- "Administration"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("operations", ignore_case = TRUE))] <- "Maintance"
nyc_jobs$job_category[[i]][str_detect(nyc_jobs$job_category[[i]],regex("maintenance ", ignore_case = TRUE))] <- "Maintance"
}
table(nyc_jobs$job_category)
nyc_jobs$salary_frequency<-as.character((nyc_jobs$salary_frequency))
nyc_jobs$salary_range_from<- as.numeric(nyc_jobs$salary_range_from)
nyc_jobs$salary_range_to<- as.numeric(nyc_jobs$salary_range_to)
#function?
nyc_jobs$salary_range_from <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", salary_range_from*1825,salary_range_from))
nyc_jobs$salary_range_to <- with(nyc_jobs, ifelse(salary_frequency == "Hourly", salary_range_to*1825,salary_range_to))
nyc_jobs$salary_range_from <- with(nyc_jobs, ifelse(salary_frequency == "Daily", salary_range_from*365*5/7,salary_range_from))
nyc_jobs$salary_range_to <- with(nyc_jobs, ifelse(salary_frequency == "Daily", salary_range_to*365*5/7,salary_range_to))
nyc_jobs<-mutate(nyc_jobs,salary_frequency="Annual") %>%
mutate(salary_mean = (salary_range_to-salary_range_from)/2+salary_range_from)
nyc_jobs$work_location<-as.character(nyc_jobs$work_location)
nyc_jobs<- nyc_jobs %>%
mutate(lon = geo$lon, lat = geo$lat) %>%
group_by(job_category)
